close all
clear
clc
% ------------------------------------------------------------------------------
prompt = '\n\n    Tell me what project you want:  ';
ls('../../');
project_ = input(prompt,'s');
% ------------------------------------------------------------------------------
ls(strcat('../../',project_,'/output/'));
prompt = '    Tell me w or dc or wdc:         ';
wdc_ = input(prompt,'s');
% ------------------------------------------------------------------------------
path_ = strcat('../../',project_,'/output/',wdc_,'/');
% ------------------------------------------------------------------------------
load(strcat(path_,'sigm_topo.mat'))
x=sigm_topo.x;
z=sigm_topo.z;
sigm=sigm_topo.sigm;
% ------------------------------------------------------------------------------
z_max=nanmax(z);
% ------------------------------------------------------------------------------
figure;
fancy_pcolor(sigm,x,z);
colormap(rainbow2(5));
% ------------------------------------------------------------------------------
xa1=binning(x,15.8);
xb5=binning(x,12.3);
xb2=binning(x,19.5);
% ------------------------------------------------------------------------------
A1s=sigm(:,xa1);
B2s=sigm(:,xb2);
B5s=sigm(:,xb5);
% ------------------------------------------------------------------------------
load('../../data/boreholes/A1_ic.txt')
load('../../data/boreholes/B2_ic.txt')
load('../../data/boreholes/B5_ic.txt')
% ------------------------------------------------------------------------------
A1ic=A1_ic;
B2ic=B2_ic;
B5ic=B5_ic;
% ------------------------------------------------------------------------------
A1ic=flip(A1ic);
B2ic=flip(B2ic);
B5ic=flip(B5ic);
% ------------------------------------------------------------------------------
a1z=A1ic(:,1);%-1;
b2z=B2ic(:,1);%-1;
b5z=B5ic(:,1);%-1;
% ------------------------------------------------------------------------------
A1ic=A1ic(:,2);
B2ic=B2ic(:,2);
B5ic=B5ic(:,2);
% ------------------------------------------------------------------------------
% pull borehole data up
[~,a1z_min] = nanmin(A1s);
[~,b2z_min] = nanmin(B2s);
[~,b5z_min] = nanmin(B5s);
% ------------------------------------------------------------------------------
a1z_min = z(a1z_min);
b2z_min = z(b2z_min);
b5z_min = z(b5z_min);
% ------------------------------------------------------------------------------
a1z = a1z-a1z_min;
b2z = b2z-b2z_min;
b5z = b5z-b5z_min;
% ------------------------------------------------------------------------------
a1z=a1z(1:binning(a1z,z_max));
b2z=b2z(1:binning(b2z,z_max));
b5z=b5z(1:binning(b5z,z_max));
% ------------------------------------------------------------------------------
A1ic=A1ic(1:binning(a1z,z_max));
B2ic=B2ic(1:binning(b2z,z_max));
B5ic=B5ic(1:binning(b5z,z_max));
% ------------------------------------------------------------------------------
% A1ic=normali(A1ic);
% B2ic=normali(B2ic);
% B5ic=normali(B5ic);
% ------------------------------------------------------------------------------
% ax = 6.25e-01 1/m
steep=8;
f_high=2e-1;
f_low =-f_high;
% ------------------------------------------------------------------------------
dz=min(diff(a1z));
A1ic_=filt_gauss(A1ic,dz,f_low,f_high,steep);
dz=min(diff(b2z));
B2ic_=filt_gauss(B2ic,dz,f_low,f_high,steep);
dz=min(diff(b5z));
B5ic_=filt_gauss(B5ic,dz,f_low,f_high,steep);
% ------------------------------------------------------------------------------
% A1s=normali(A1s);
% B2s=normali(B2s);
% B5s=normali(B5s);
% ------------------------------------------------------------------------------
A1s=A1s*1e+3;
B2s=B2s*1e+3;
B5s=B5s*1e+3;
% ------------------------------------------------------------------------------
figure;
% ------------------------------------------------------------------------------
subplot(1,3,1)
hold on;
plot(B5s,z,'r-')
plot(B5ic,b5z,'k-')
% plot(B5ic_,b5z,'b-')
hold off;
axis ij
ylabel('Depth (m)')
title('B5')
simple_figure()
% ------------------------------------------------------------------------------
subplot(1,3,2)
hold on;
plot(A1s,z,'r-')
plot(A1ic,a1z,'k-')
% plot(A1ic_,a1z,'b-')
hold off;
axis ij
xlabel('Induced and DC conductivity (mS/m)')
ylabel('Depth (m)')
title('A1')
simple_figure()
% ------------------------------------------------------------------------------
subplot(1,3,3)
hold on;
plot(B2s,z,'r-')
plot(B2ic,b2z,'k-')
% plot(B2ic_,b2z,'b-')
hold off;
axis ij
ylabel('Depth (m)')
title('B2')
simple_figure()
% ------------------------------------------------------------------------------
% fig = gcf;fig.PaperPositionMode = 'auto';print(gcf,'ic','-dpng','-r1000')
% ------------------------------------------------------------------------------