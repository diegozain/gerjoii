% ------------------------------------------------------------------------------
% 
% generate output models from the machine learning shit 
% 
%
% ------------------------------------------------------------------------------
clear
close all
clc
% ------------------------------------------------------------------------------
pwd_ = pwd;
cd ../../../../
dir_paths;
cd(pwd_);
% ------------------------------------------------------------------------------
% build geometry and initial guess
% ------------------------------------------------------------------------------
pwd_ = pwd;
cd ../../
param_wdc;
cd(pwd_);
% ------------------------------------------------------------------------------
[parame_,finite_,geome_] = wdc_geom(parame_);
% ------------------------------------------------------------------------------
% set permittivities, conductivities and depths of second layer
% ------------------------------------------------------------------------------
model_param;
% ------------------------------------------------------------------------------
path_ = '../pics-ml/';
path__= '../data-set/test/';
% ------------------------------------------------------------------------------
I_esti = readNPY(strcat(path_,'classes_esti.npy'));
% ------------------------------------------------------------------------------
for i_=1:n_models_2l
 I_    = I_esti(i_,:);
 [~,I_]= sort(I_);
 I_    = flip(I_);
 I_    = ls2enum_c(I_,n_models_2l);
 % -----------------------------------------------------------------------------
 [epsi_esti,sigm_esti,I_] = w_model_2l_(geome_.X,geome_.Y,eps_,sig_,lam_,I_);
 % -----------------------------------------------------------------------------
 path_s = strcat(path__,num2str(i_),'/','epsi_esti.mat');
 save(path_s,'epsi_esti');
 % -----------------------------------------------------------------------------
 path_s = strcat(path__,num2str(i_),'/','sigm_esti.mat');
 save(path_s,'sigm_esti')
 % -----------------------------------------------------------------------------
 fprintf('\n finished saving model # %i',i_);
end
fprintf('\n ok, Im done now\n')
% ------------------------------------------------------------------------------
